id:  defense logic order
comment: |
  This can't be the best way to do this. Can a DADict act like a checkboxes dictionary?
code: |
  defense_rent_pleading_requirement
  defense_lease_not_attached
  defense_tender_refused
  defense_rent_payment
  defense_settlement
  defense_lease_signed_under_duress
  defense_fraud_lease
  defense_liquidated_damages_late_fees
  defense_breach_of_habitability
  defense_breach_of_cqe
  defense_estoppel_illegality
  defense_foreclosure
  defense_new_owner_failed_to_provide_notice_of_sale
  defense_unrepresented_corporation
  defense_no_landlord_tenant_relationship
  defense_excessive_rent_for_subsidized_housing
  # UD defenses
  defense_failure_to_terminate
  defense_ud_no_written_notice
  defense_ud_no_rental_period_notice
  defense_ud_lease_requirements
  defense_termination_notice_required_by_law

  defense_logic = True
---
id: rent pleadings requirement logic
depends on:
  - tenant_got_summons
  - petition_available
  - petition_alleges_nonrent
  - petition_states_rent_amount
  - lease_attached
  - petition_states_terms_of_lease
  - petition_states_rent_periods
  - petition_states_demand_made
  - trial_court.circuit
  - petition_separates_nonrent
  - has_written_lease
code: |
  if tenant_got_summons and petition_available:
    if petition_alleges_nonrent or not petition_states_rent_amount or (not has_written_lease and not petition_states_terms_of_lease) or (has_written_lease and not lease_attached and not petition_states_terms_of_lease) or not petition_states_rent_periods or not petition_states_demand_made or (trial_court.circuit == 21 and not petition_separates_nonrent):
      defense_rent_pleading_requirement = True
    else:
      defense_rent_pleading_requirement = False
  else:
      defense_rent_pleading_requirement = None
---
id: lease not attached logic
depends on:
  - tenant_got_summons
  - petition_available
  - lease_attached
  - has_written_lease
code: |
  if tenant_got_summons and petition_available:
    if has_written_lease and not lease_attached:
      defense_lease_not_attached = True
    else:
      defense_lease_not_attached = False
  else:
      defense_lease_not_attached = None
---
id: tender refused logic
depends on: offer_attempts
code: |
  defense_tender_refused = False
  if offer_attempts.there_are_any:
    for offer in offer_attempts:
      if offer.has_refused_payment and offer.was_attempt_full:
        defense_tender_refused = True
comment: |
  add date requirement
---
id: rent payment defense logic
code: |
  if was_rent_paid:
    defense_rent_payment = True
  else:
    defense_rent_payment = False
depends on: was_rent_paid
---
id: settlement defense logic
code: |
  if landlord_agreement and tenant_compliance_with_agreement:
    defense_settlement = True
  else:
    defense_settlement = False
depends on:
  - landlord_agreement
  - tenant_compliance_with_agreement
---
id: made settlement
question: |
  % if person_answering == "tenant":
  Did you already make an agreement with your landlord to stop the eviction?
  % else: 
  Did the tenant already make an agreement with their landlord to stop the eviction?
  % endif
subquestion: |
  A landlord and tenant can agree to "settle" an eviction case, which means an agreement to stop the eviction.
fields:
  - label: |
      % if person_answering == "tenant":
      Did you make a settlement agreement with your landlord?
      % else: 
      Did the tenant make a settlement agreement with their landlord?
      % endif
    field: landlord_agreement
    datatype: yesnoradio
  - label: |
      % if person_answering == "tenant":
      Did you follow the terms of the agreement?
      % else: 
      Did the tenant follow the terms of the agreement?:
      % endif
    field: tenant_compliance_with_agreement
    datatype: yesnoradio
    show if: landlord_agreement
---
id: unfair duress defense logic
code: |
  defense_lease_signed_under_duress = unfair_duress
depends on:
  - unfair_duress
---
id: duress
question: |
  % if person_answering == "tenant":
  Did the landlord unfairly make or pressure you to sign the lease?
  % else: 
  Did the landlord unfairly make or pressure the tenant to sign the lease?
  % endif
subquestion: |
  ${ collapse_template(unfair_duress_explanation_template) }
fields:
  - label: |
      % if person_answering == "tenant":
      Did the landlord unfairly make or pressure you to sign the lease?
      % else: 
      Did the landlord unfairly make or pressure the tenant to sign the lease?
      % endif
    field: unfair_duress
    datatype: yesnoradio
---
template: unfair_duress_explanation_template
subject: |
  What counts as "unfair pressure"?
content: |
  Only a judge can decide. But unfair pressure may include:
  
  % if person_answering == "tenant":
  * A threat to hurt you or someone else,
  % else:
  * A threat to hurt the tenant or someone else,
  % endif
  * An **implied** threat to hurt you or someone else, or
  * Extreme psychological pressure.
---
id: false promises defense logic
code: |
  if len(false_promises) > 0 and relied_on_false_promises:
    defense_fraud_lease = True
  else:
    defense_fraud_lease = False
depends on:
  - false_promises
  - relied_on_false_promises
---
objects:
  - false_promises: DAList
---
id: landlord lied
question: |
  % if person_answering == "tenant":
  Did your landlord tell you something that was not true to get you to sign the lease?
  % else:
  Did the landlord tell the tenant something that was not true to get the tenant to sign the lease?
  % endif
subquestion: |
  If your landlord tricked you into signing the lease by telling you
  something that was not true, you may have a defense.

  ${ collapse_template(false_promise_example_template) }
fields:
  - label: |
      % if person_answering == "tenant":
      Did your landlord make any false promises to you before you signed the lease?
      % else: 
      Did the landlord make any false promises to the tenant before the tenant signed the lease?
      % endif
    field: false_promises.there_are_any
    datatype: yesnoradio
  - label: |
      % if person_answering == "tenant":
      What was the **first** false promise your landlord made to you?
      % else: 
      What was the **first** false promise the landlord made to the tenant?
      % endif
    field: false_promises[0]
    show if: false_promises.there_are_any
---
template: false_promise_example_template
subject: |
  What counts as a false promise?
content: |
  % if person_answering == "tenant":
  If your landlord told you something that got you to sign the lease and
  that turned out not to be true, it may be a false promise.

  For example:

  * Promising to paint a room,
  * Promising to replace a carpet, or
  * Promising that an old appliance would get replaced before you moved in.

  Those may count as false promises. What matters is that you would not
  have signed the lease if your landlord had not told you something that
  turned out not to be true.
  % else: 
  If the landlord told the tenant something that got the tenant to sign the 
  lease and that turned out not to be true, it may be a false promise.

  For example:

  * Promising to paint a room,
  * Promising to replace a carpet, or
  * Promising that an old appliance would get replaced before the tenant moved 
  in.

  Those may count as false promises. What matters is that the tenant would not
  have signed the lease if the landlord had not told the tenant something that
  turned out not to be true.
  % endif
  
  A false promise can also be a written promise, or a promise in an advertisement.
---
id: promises i
question: |
  % if person_answering == "tenant":
  What was the **${ ordinal(i) }** false promise your landlord made?
  % else: 
  What was the **${ ordinal(i) }** false promise the landlord made?
  % endif
subquestion: |
  % if person_answering == "tenant":
  You already told us about:
  % else:
  The tenant already told us about:
  % endif

  % for promise in false_promises:
  * ${ promise }
  % endfor
fields:
  - Describe the landlord's false promise: false_promises[i]
---
id: false promises there is another
question: |
  % if person_answering == "tenant":
  Did your landlord promise anything else that was not true?
  % else:  
  Did the landlord promise anything else that was not true?
  % endif
subquestion: |
  % if person_answering == "tenant":
  You already told us about:
  % else:
  The tenant already told us about:
  % endif

  % for promise in false_promises:
  * ${ promise }
  % endfor
fields:
  - label: |
      % if person_answering == "tenant":
      Did your landlord promise anything else that was not true? 
      % else: 
      Did the landlord promise anything else that was not true? 
      % endif
    field: false_promises.there_is_another
    datatype: yesnoradio
---
id: relied on promise
question: |
  % if person_answering == "tenant":
  Did your landlord's promise get you to sign the lease?
  % else: 
  Did the landlord's promise get the tenant to sign the lease?
  % endif
subquestion: |
  % if person_answering == "tenant":
  % if false_promises.number() == 1:
  You told us the landlord made 1 false promise:
  % else:
  You told us the landlord made ${ false_promises.number() } false promises:
  % endif
  % else: 
  % if false_promises.number() == 1:
  The tenant told us the landlord made 1 false promise:
  % else:
  The tenant told us the landlord made ${ false_promises.number() } false 
  promises:
  % endif
  % endif

  % for promise in false_promises:
  * ${ promise }
  % endfor
fields:
  - note: |
      % if person_answering == "tenant":
      % if false_promises.number() == 1:
      If you were more likely to sign the lease **because** of 
      your landlord's promise, answer yes.
      % else:
      If you were more likely to sign the lease **because** of 
      your landlord's promises, answer yes.
      % endif
      % else: 
      % if false_promises.number() == 1:
      If the tenant was more likely to sign the lease **because** of 
      the landlord's promise, answer yes.
      % else:
      If the tenant was more likely to sign the lease **because** of 
      the landlord's promises, answer yes.
      % endif
      % endif
  - label: |
      % if person_answering == "tenant":
      % if false_promises.number() == 1:
      Did your landlord's promise get you to sign the lease?
      % else:
      Did your landlord's promises get you to sign the lease?
      % endif
      % else: 
      % if false_promises.number() == 1:
      Did the landlord's promise get the tenant to sign the lease?
      % else:
      Did the landlord's promises get the tenant to sign the lease?
      % endif
      % endif
    field: relied_on_false_promises
    datatype: yesnoradio
---
id: late fees defense logic
code: |
  if late_fees_assessed and (late_fees_penalty or ((not late_fees_lease_provision) or late_fee_doesnt_comply_with_lease)):
    defense_liquidated_damages_late_fees = True
  else:
    defense_liquidated_damages_late_fees = False
depends on:
  - late_fees_assessed
  - late_fees_penalty
  - late_fees_lease_provision
  - late_fee_doesnt_comply_with_lease
---
id: late fees
question: |
  % if person_answering == "tenant":
  Did your landlord say that you owe a late fee?
  % else: 
  Did the landlord say that the tenant owes a late fee?
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Did your landlord say that you owe fees for paying rent late?
      % else: 
      Did the landlord say that the tenant owes fees for paying rent late?
      % endif
    field: late_fees_assessed
    datatype: yesnoradio
  - note: |
      <h2 class="h4">Was the amount the landlord charged "fair"?</h2>
      It is up to a judge to decide if the late fee is "fair". But if the late fee is
      a lot more than:

      * The interest the money could earn in a bank, plus
      * The cost of the landlord's time to handle the late payment,

      The fee may be too high.
      
      In some counties, more than $5 per day is considered too high.
    show if: late_fees_assessed
  - label: |
      % if person_answering == "tenant":
      Is the late fee more than a fair amount to cover the landlord's cost?
      % else: 
      Is the tenant's late fee more than a fair amount to cover the landlord's cost?
      % endif
    field: late_fees_penalty
    datatype: yesnomaybe
    show if: late_fees_assessed
  - label: |
      Is there a part of the lease that allows the landlord to charge the late fee?
      % if has_written_lease == False:
      You can answer no if you don't have a written lease.
      % endif
    field: late_fees_lease_provision
    datatype: yesnomaybe
    show if: late_fees_assessed
  - label: |
      Do the late fees charged by the landlord comply with the lease provision?
      % if has_written_lease == False:
      You can answer no if you don't have a written lease.
      % endif
    field: late_fee_doesnt_comply_with_lease
    datatype: noyesmaybe
    show if: late_fees_lease_provision
---
id: cqe breach logic
comment: |
  Are we going to separate levels of cqe breach? E.g. (1) mere breach, (2) constructive eviction, (3) significant enough to physically deprive the tenant of possession.
code: |
  if cqe_breaches.any_true():
    defense_breach_of_cqe = True
  else:
    defense_breach_of_cqe = False
depends on: cqe_breaches
---
id: estoppel defense logic
code: |
  if estoppel_breaches.any_true() or defense_breach_of_cqe:
    defense_estoppel_illegality = True
  else:
    defense_estoppel_illegality = False
depends on:
  - estoppel_breaches
  - defense_breach_of_cqe
---
id: warranty breach logic
code: |
  if warranty_breaches.any_true() == True:
    defense_breach_of_habitability = True
  else:
    defense_breach_of_habitability = False
depends on:
  - warranty_breaches
  - notice_of_breach_to_landlord
---
id: notice of problems fact
question: |
  % if person_answering == "tenant":
  Did you tell the landlord about the problems that needed to get repaired?
  % else: 
  Did the tenant tell the landlord about the problems that needed to get repaired?
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Did you let the landlord know about at least one of these problems, either by writing to the landlord or talking to the landlord?
      % else: 
      Did the tenant let the landlord know about at least one of these problems, either by writing to the landlord or talking to the landlord?
      % endif
    field: notice_of_breach_to_landlord
    datatype: yesnomaybe
---
id: foreclosure defense logic
code: |
  if landlord_foreclosed and not notice_of_foreclosure:
    defense_foreclosure = True
  else:
    defense_foreclosure = False
depends on:
  - landlord_foreclosed
  - notice_of_foreclosure
---
id: had foreclosure
question: |
  Did the bank ever foreclose on this home?
fields:
  - label: |
      % if person_answering == "tenant":
      As far as you know during the time that you were a tenant, did a bank foreclose on the property?
      % else: 
      As far as you know during the time that the tenant lived in the property, did a bank foreclose on the property?
      % endif
    field: landlord_foreclosed
    datatype: yesnomaybe
  - label: |
      % if person_answering == "tenant":
      Did you get a letter that told you about the foreclosure?
      % else: 
      Did the tenant get a letter that told them about the foreclosure?
      % endif
    field: notice_of_foreclosure
    datatype: yesnomaybe
    show if: landlord_foreclosed
---
id: new owner logic for all counties
code: |
  if previous_landlord_sold_property and (notice_of_sale_provided_new_landlord == False or not notice_contains_sale_document == False):
    defense_new_owner_failed_to_provide_notice_of_sale = True
  else:
    defense_new_owner_failed_to_provide_notice_of_sale = False
depends on:
  - previous_landlord_sold_property
  - notice_of_sale_provided_new_landlord
  - notice_contains_sale_document
  - trial_court.classification
---
depends on: trial_court.classification
if: |
  trial_court.classification.strip() != "Class 1"
id: new owner facts for non-class 1 counties
question: |
  Did your landlord ever sell the house while you were a tenant at this address?
fields:
  - Was your house sold to a new landlord while you lived in it?: previous_landlord_sold_property
    datatype: yesnomaybe
  - Did your new landlord give you a letter that told you about the sale?: notice_of_sale_provided_new_landlord
    datatype: yesnomaybe
    show if: previous_landlord_sold_property
  - Did that letter have a copy of the deed?: notice_contains_sale_document
    datatype: yesnomaybe
    show if: notice_of_sale_provided_new_landlord
---
depends on: trial_court.classification
if: |
  trial_court.classification.strip() == "Class 1"
id: new owner facts for class 1 counties
question: |
  % if person_answering == "tenant":
  Did your landlord ever sell the house while you were living at this address?
  % else:
  Did the landlord ever sell the house while the tenant was living at this address?
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Was your house sold to a new landlord while you lived in it?
      % else: 
      Was the house sold to a new landlord while the tenant lived in it?
      % endif
    field: previous_landlord_sold_property
    datatype: yesnomaybe
  - label: |
      % if person_answering == "tenant":
      Did your new landlord give you a letter that told you about the sale?
      % else: 
      Did the new landlord give the tenant a letter that told them about the sale?
      % endif
    field: notice_of_sale_provided_new_landlord
    datatype: yesnomaybe
    show if: previous_landlord_sold_property
  - Did that letter have a copy of the deed, or a notarized document signed both by the original landlord and the new landlord?: notice_contains_sale_document
    datatype: yesnomaybe
    show if: notice_of_sale_provided_new_landlord
---
id: unrepresented landlord defense logic
code: |
  temp_counter = 0
  for op in other_parties:
    if not op.attorney.there_are_any and op.person_type == "business":
      temp_counter += 1
  if temp_counter > 0:
      defense_unrepresented_corporation = True
  else:
      defense_unrepresented_corporation = False
depends on:
  - other_parties
---
id: lease not attached defense
code: |
  if defense_lease_not_attached or defense_lease_signed_under_duress or defense_fraud_lease:
    defense_no_landlord_tenant_relationship = True
  else:
    defense_no_landlord_tenant_relationship = False
depends on:
  - defense_lease_not_attached
  - defense_lease_signed_under_duress
  - defense_fraud_lease
---
id: subsidized excessive rent defense
code: |
  if is_rent_subsidized and excessive_rent:
    defense_excessive_rent_for_subsidized_housing = True
  else:
    defense_excessive_rent_for_subsidized_housing = False
depends on:
  - is_rent_subsidized
  - excessive_rent
---
variable name: times_per_year_list
data:
  - [52, "Weekly"]
  - [26, "Once every two weeks"]
  - [24, "Twice per month"]
  - [12, "Monthly"]
  - [4, "Once every 3 months"]
  - [2, "Once every 6 months"]
  - [1, "Yearly"]  
---
id: subsidized housing identification
question: |
  % if person_answering == "tenant":
  What kind of housing do you have?
  % else: 
  What kind of housing does the tenant have?
  % endif
subquestion: |
  % if person_answering == "tenant":
  It may help to look at your lease to answer this question.
  % else:
  It may help to look at the tenant's lease to answer this question.
  % endif
  If you do not have it, do your best to answer from your memory.

  ${ collapse_template(why_tenancy_facts_template) }
fields:
  - label: |
      % if person_answering == "tenant":
      Do you get a rent subsidy or do you live in public housing?
      % else: 
      Does the tenant get a rent subsidy or do they live in public housing?
      % endif
    field: is_rent_subsidized
    datatype: yesnoradio
  - label: |
      What kind?
    field: subsidized_housing_type
    datatype: radio
    choices:
      - ${ subsidized_housing_text["voucher"] }: voucher
      - ${ subsidized_housing_text["public"] }: public
        help: |
          % if person_answering == "tenant":
          In public housing, your landlord is usually the city or county.
          % else:
          In public housing, the tenant's landlord is usually the city or 
          county.
          % endif
      - ${ subsidized_housing_text["taxcredit"] }: taxcredit
      - ${ subsidized_housing_text["project"] }: project   
    show if:
      variable: is_rent_subsidized
      is: True
  - Do you live in a mobile home that you own, and rent the land?: is_mobile_home_owner
    datatype: yesnoradio
    show if:
      variable: is_rent_subsidized
      is: False
  - How many units are in the building or apartment complex?: number_of_units_in_building
    input type: radio
    show if:
      variable: is_rent_subsidized
      is: False
    choices:
      - One (single-family): one
      - More than 1 but fewer than 4: fewer_than_four
      - 4 or more: four_or_more
  - label: |
      % if person_answering == "tenant":
      What kind of lease do you have?
      % else:
      What kind of lease does the tenant have?
      % endif
    field: kind_of_lease_agreement
    input type: radio
    choices:
      - A lease for a fixed period of time (like 1 year): fixed_period
      - A month-to-month, week-to-week or other lease that automatically renews: periodic
      - I don't have have a written lease: no_written_lease
      - I don't know: dont_know
  - What day does the lease end?: fixed_period_end_date
    datatype: date
    show if:
      variable: kind_of_lease_agreement
      is: fixed_period
  - label: |
      **Self-extending leases.**

      Some leases include a term that says the lease will automatically renew
      or that it will turn into a month-to-month lease when the term ends.

      For example: _"a new tenancy from month-to-month shall be created between Landlord and Tenant...,"_
      or: _"This lease shall automatically renew for successive terms ... unless..."_

      Does this lease include a term like that?
    label above field: True
    show if:
      variable: kind_of_lease_agreement
      is: fixed_period
    field: is_self_extending_lease
    datatype: yesnomaybe
  - label: |
      **How often** is rent due?
    field: rent_period
    input type: radio
    code: |
      times_per_year_list
    show if:
      variable: kind_of_lease_agreement
      is: periodic
  - label: |
      What **day** is rent due?
      (enter a number, like **1** for the first day of the month or week)
    help: |
      The most common rent days are the first and the 5th of the month.
    field: rent_day
    datatype: integer
    show if:
      variable: kind_of_lease_agreement
      is: periodic
---
template: why_tenancy_facts_template
subject: |
  Why does this matter?
content: |
  The questions on this page help decide:
  
  * what kind of notice the landlord must give you
  * whether your landlord must follow discrimination laws

  Depending on your answer you may have a defense to the eviction.
---
variable name: subsidized_housing_text
use objects: True
data:
  voucher:
    question: Mobile voucher (like Section 8)
    document: Section 8 housing choice vouche
  public:
    question: Public housing
    document: Public housing
  taxcredit:
    question: Tax Credit
    document: Tax Credit
  project:
    question: |
      ${ "Housing project run by a private landlord (and I pay 30% of my income for rent)" if person_answering == "tenant" else "Housing project run by a private landlord (and the tenant pays 30% of their income for rent)"}  
    document: |
      Section 8 project-based housing development
---
id: rent not owed by tenant
question: |
  % if person_answering == "tenant":
  Because you get a rent subsidy
  % else:
  Because the tenant gets a rent subsidy
  % endif
subquestion: |
  Some landlords ask their tenant to pay:

  * Extra rent that is more than the rent the housing authority said the landlord can charge, or
  * Part of the rent the housing authority would normally pay but the housing authority has stopped payment.

  % if person_answering == "tenant":
  Your landlord can only charge you the amount that you are responsible for, based on your income. You never owe more than your tenant rent share.
  % else:
  The tenant's landlord can only charge them the amount that the tenant is responsible for, based on their income. The tenant never owes more than their tenant rent share.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Is your landlord asking you to pay an amount that is more than your tenant rent share?
      % else: 
      Is the tenant's landlord asking them to pay an amount that is more than their tenant rent share?
      % endif
    field: excessive_rent
    datatype: yesnoradio
---
id: petition requirements - rent amount
question: |
  % if person_answering == "tenant":
  How much rent does your landlord say that you owe?
  % else: 
  How much rent does the tenant's landlord say that they owe?
  % endif
subquestion: |
  % if tenant_got_summons:
  Look at the Summons and Petition to answer this question.

  Look for a line that looks something like this:

  [FILE ComplaintRentAmount.png, 100%]

  The landlord's petition may look different.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Does the petition say what amount of rent you owe?
      % else:
      Does the petition say what amount of rent the tenant owes?
      % endif 
    field: petition_states_rent_amount
    datatype: yesnoradio
  - label: |
      % if person_answering == "tenant":
      How much does the Landlord's Petition say that you owe **in rent**?
      % else:
      How much does the Landlord's Petition say that the tenant owes **in rent**?
      % endif 
    field: rent_amount_owed
    datatype: currency
    show if: petition_states_rent_amount
  - label: |
      % if person_answering == "tenant":
      Does the petition say you owe an amount **other** than rent?  (Not including attorney fees and costs from the eviction case.)
      % else:
      Does the petition say the tenant owes an amount **other** than rent? (Not including attorney fees and costs from the eviction case.)
      % endif 
    field: other_charges_alleged
    datatype: yesnomaybe
  - note: |
      Other charges may include a pet fee, cleaning fee, fee for repairs, etc.
---
id: rent separated from other charges
question: |
  % if person_answering == "tenant":
  Does the petition separate the amount you owe in rent from other charges?
  % else:
  Does the petition separate the amount the tenant owes in rent from other charges?
  % endif
fields:
  - Are rent charges separated from other charges: petition_separates_nonrent
    datatype: yesnomaybe
---
depends on: petition_states_rent_amount
code: |
  if petition_states_rent_amount:
    petition_alleges_nonrent = False
  else:
    petition_alleges_nonrent = True
---
id: notice to terminate
question: |
  Notice to terminate tenancy
subquestion: |
  % if person_answering == "tenant":
  Your landlord must give you a notice to end your tenancy
  before filing an eviction case. 
  The amount of time that the landlord must give you depends on the kind 
  of tenancy you have.
  % else:
  The tenant's landlord must give the tenant a notice to end their tenancy
  before filing an eviction case.
  The amount of time that the landlord must give the tenant depends on the kind
  of tenancy the tenant has.
  % endif

  The notice might be called:

  * Lease termination,
  * Notice to Quit,
  * Notice to Terminate Tenancy, or
  * Notice to Vacate.

  There is no standard form for the notice.

  If you do not have the notice in front of you, do your best to answer
  from memory.
fields:
  - label: |
      % if person_answering == "tenant":
      Did you get a written notice to end your tenancy?
      % else:
      Did the tenant get a written notice to end their tenancy?
      % endif
    field: got_notice_to_terminate
    datatype: yesnomaybe
  - About what day did you **get** the notice?: received_notice_date
    datatype: date
    show if: got_notice_to_terminate
    max: ${ today().format("yyyy-MM-dd") }
  - Did the notice include a specific day to **end** your tenancy?: notice_to_terminate_includes_specific_day
    input type: radio
    choices:
      - Yes, it had a specific day: specific_day
      - It said to move at the end of the next rental period: rental_period
      - It did not say when to move: no_specific_day
      - It said something else: something_else
    show if: got_notice_to_terminate
  - What day did the notice say it would end your tenancy?: termination_of_tenancy_date
    datatype: date
    max: ${ today().format("yyyy-MM-dd") }
    show if:
      variable: notice_to_terminate_includes_specific_day
      is: specific_day
---
id: lease requirement for notice
question: |
  % if person_answering == "tenant":
  Notice requirements in your lease
  % else:
  Notice requirements in the tenant's lease
  % endif
subquestion: |
  Look at the lease to answer this question. If you do not have
  the lease in front of you, do your best to answer from memory.

  Most leases will include a specific amount of notice that the landlord
  must give the tenant before filing an eviction case. For example:
  it may say that you must act to fix any problem they notify you about
  within 7, 10, or 30 days. In the lease, look for a section labeled
  "Termination," "Notice" or "Default."
fields:
  - Does the lease say how much notice the landlord must give to the tenant?: lease_says_how_much_notice
    datatype: yesnomaybe
  - label: |
      **Summarize the notice amount from the lease.**
      
      For example:

      you can write "30 days" or "the end of next rental period,"
      depending on what the lease says.
    label above field: True
    field: notice_required_by_lease
    datatype: area
    rows: 2
    show if: lease_says_how_much_notice
  - label: |
      % if person_answering == "tenant":
      **Did the landlord give you the amount of notice required by the lease?**

      % if notice_to_terminate_includes_specific_day == "specific_day":
      Earlier, you said you got ${ (termination_of_tenancy_date - received_notice_date).days } days notice.
      % endif
      % else:
      **Did the landlord give the tenant the amount of notice required by the lease?**

      % if notice_to_terminate_includes_specific_day == "specific_day":
      Earlier, you said the tenant got ${ (termination_of_tenancy_date - received_notice_date).days } days notice.
      % endif
      % endif

      Answer as well as you can.
    field: landlord_gave_notice_required_by_lease
    datatype: yesnomaybe
    show if: lease_says_how_much_notice
---
depends on:
  - got_notice_to_terminate
code: |
  defense_ud_no_written_notice = not got_notice_to_terminate
---
depends on:
  - is_mobile_home_owner
  - rent_day
  - rent_period
  - received_notice_date
  - notice_to_terminate_includes_specific_day
  - termination_of_tenancy_date
code: |
  defense_ud_no_rental_period_notice = check_improper_notice(
    is_mobile_home_owner,
    rent_day,
    rent_period,
    received_notice_date,
    notice_to_terminate_includes_specific_day,
    termination_of_tenancy_date
  )  
---
code: |
  if kind_of_lease_agreement == "no_written_lease":
    has_written_lease = False
  else:
    has_written_lease = True
---
id: petition requirements - terms of lease
question: |
  % if person_answering == "tenant":
  Does the petition say what the terms of your rental agreement are?
  % else:
  Does the petition say what the terms of the tenant's rental agreement are?
  % endif
subquestion: |
  % if person_answering == "tenant":
  With the Landlord's Petition, your landlord must have either:
  
   1. attached a copy of the lease, or
   2. written a summary of your rental agreement, including the monthly rent, the kind of agreement (year to year or month to month), and the day rent is due.
  % else: 
    With the Landlord's Petition, the tenant's landlord needs to either:
  
   1. attach a copy of the lease, or
   2. write a summary of the tenant's rental agreement, including the monthly rent, the kind of agreement (year to year or month to month), and the day rent is due.
  % endif
  
  The petition looks different in different counties. But it may look like this:

  [FILE ComplaintTerms.png, 100%]
fields:
  - "Is the lease attached to the Landlord's Petition?": lease_attached
    datatype: yesnoradio
    show if:
      code: |
        has_written_lease
  - note: |
      <h2 class="h4">Summary of rental agreement</h2>
      The Petition should include a summary of the rental agreement. It should include 
      at least:

      * The rent amount,
      * The day rent is due, and
      * The kind of agreement (year to year or month to month).
    js show if: |
      val("has_written_lease") === false || val("lease_attached") === false    
  - label: |
      % if person_answering == "tenant":
      Does the Landlord's Petition include a summary of your rental agreement?
      % else:
      Does the Landlord's Petition include a summary of the tenant's rental agreement?
      % endif 
    field: petition_states_terms_of_lease
    datatype: yesnomaybe
    show if:
      variable: lease_attached
      is: False
  - label: |
      % if person_answering == "tenant":
      Does the Landlord's Petition include a summary of your rental agreement?
      % else:
      Does the Landlord's Petition include a summary of the tenant's rental agreement?
      % endif 
    field: petition_states_terms_of_lease
    datatype: yesnomaybe
    show if:
      code: |
        not has_written_lease
---
id: petition requirements - periods due
question: |
  % if person_answering == "tenant":
  Does the petition say the amount you owe for each month?
  % else: 
  Does the petition say the amount the tenant owes for each month?
  % endif
subquestion: |
  % if person_answering == "tenant":
  The Landlord's Petition must say what months you allegedly owe rent for.
  % else: 
  The Landlord's Petition must say what months the tenant allegedly owes rent for.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Does the petition say a specific amount for each month your landlord says you owe rent?
      % else:
      Does the petition say a specific amount for each month the landlord says the tenant owes rent?
      % endif 
    field: petition_states_rent_periods
    datatype: yesnomaybe
---
if: |
  petition_states_rent_amount == False
code: |
  petition_states_rent_periods = False
---
id: petition requirements - demand
question: |
  Does the Petition say that the landlord demanded rent?
subquestion: |
  % if person_answering == "tenant":
  The Landlord's Petition must say that the "landlord demanded rent", meaning that the landlord told you that you had to pay rent or leave.
  % else:
  The Landlord's Petition must say that the "landlord demanded rent", meaning that the landlord told the tenant that they had to pay rent or leave.
  % endif
  
  The Demand may look like this, but can have different language:
  
  [FILE ComplaintDemand.png, 100%]
 
fields:
  - "Does the Landlord's Petition say the landlord demanded rent?": petition_states_demand_made
    datatype: yesnomaybe
---
id: is seeking past due rent true
comment: |
  DOCKET
  (PETITION)
question: |
  Is the landlord seeking recovery of past-due rent?
help:
  label: |
    How do I find this?
  content: |
    This information can be found on the **Docket** or the **Petition**.
    
    (TODO: Insert information to help user locate this information on the Docket and Petition)
fields:
  - "": is_rent_sought
    datatype: yesno
    input type: yesnoradio
---
id: has refused payment
comment: |
  ADDITIONAL
  (TODO: support multiple refusal dates)
  (TODO: implement Other explanation)
  (TODO: change was_attempt_full question options from Yes/No to Full/Partial)
question: |
  % if person_answering == "tenant":
  Did you try to pay the rent?
  % else: 
  Did the tenant try to pay the rent?
  % endif
subquestion: |
  % if person_answering == "tenant" and petition_states_rent_amount:
  Your landlord said you owe ${ currency(rent_amount_owed) }. Think about this amount when you answer
  the questions on this page.
  % elif person_answering in ["attorney","tenant_helper"] and petition_states_rent_amount:
    The landlord said the tenant owes ${ currency(rent_amount_owed) }. The tenant should think about this amount when they answer
  the questions on this page.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Did you offer to give your landlord the money they say you owe?
      % else:
      Did the tenant offer to give the landlord the money they say the tenant owes?
      % endif 
    field: offer_attempts.there_are_any
    datatype: yesnoradio
---
id: payment attempt loop
question: |
  % if person_answering == "tenant":
  Information about the ${ ordinal(i) } time you tried to pay the rent
  % else: 
  Information about the ${ ordinal(i) } time the tenant tried to pay the rent
  % endif
subquestion: |
  % if i > 0:
  % if person_answering == "tenant":
  So far, you said you
  % else: 
  So far, the tenant said they
  % endif
  % for offer in offer_attempts.complete_elements():
  
   - Tried to pay ${ "the full amount" if offer.was_attempt_full else "part of the rent" } on ${ offer.attempt_date } ${ offer.attempt_method } but the landlord refused.
   
  % endfor
  % endif
fields:
  - When?: offer_attempts[i].attempt_date
    datatype: date
  - label: |
      % if person_answering == "tenant":
      How did you try to give your landlord the money?
      % else:
      How did the tenant try to give the landlord the money?
      % endif 
    field: offer_attempts[i].attempt_method
    input type: radio
    choices:
      - ${"I wrote a letter" if person_answering == "tenant" else "Wrote a letter"}: "by letter"
      - ${"I sent an email" if person_answering == "tenant" else "Sent an email"}: "by email"
      - ${"I told my landlord in person" if person_answering == "tenant" else "Told the landlord in person"}: "in person"
      - ${"I told my landlord in a phone call" if person_answering == "tenant" else "Told the landlord in a phone call"}: "in a phone_call"
      - Other: "other"
  - label: |
      % if person_answering == "tenant":
      How much did you offer to pay?
      % else:
      How much did the tenant offer to pay?
      % endif 
    field: offer_attempts[i].was_attempt_full
    datatype: radio
    choices:
      - All of the money: True
      - Part of the money: False
  - label: |
      % if person_answering == "tenant":
      Did your landlord say no to your offer to pay?
      % else:
      Did the landlord say no to the tenant's offer to pay?
      % endif 
    field: offer_attempts[i].has_refused_payment
    datatype: yesnoradio
  - label: |
      % if person_answering == "tenant":
      Did your landlord say no in a writing that you can bring to court? Did someone else see your landlord say "no"?
      % else:
      Did the landlord say no in a writing that the tenant can bring to court? Did someone else see the tenant's landlord say "no"?
      % endif 
    field: offer_attempts[i].has_attempt_evidence
    datatype: yesnoradio
#  - note: |
#      ${ collapse_template(example_of_refused_payment_evidence) }
#    show if: offer_attempts[i].has_refused_payment
---
#template: example_of_refused_payment_evidence
#subject: |
#  What kind of evidence?
#content: |
#  For example, a letter from the landlord refusing to accept the money, a written check or money order, or a witness to the landlord's refusal.
---
question: |
  % if person_answering == "tenant":
  Did you make any other attempts to pay the rent?
  % else: 
  Did the tenant make any other attempts to pay the rent?
  % endif
subquestion: |
  % if len(offer_attempts.complete_elements()) > 0:
  % if person_answering == "tenant":
  So far, you said you
  % else: 
  So far, the tenant said they
  % endif
  % for offer in offer_attempts.complete_elements():
  
   - tried to pay ${ "the full amount" if offer.was_attempt_full else "part of the rent" } on ${ offer.attempt_date } ${ offer.attempt_method } but the landlord refused.
   
  % endfor
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Did you make any other attempts to pay the rent?
      % else:
      Did the tenant make any other attempts to pay the rent?
      % endif 
    field: offer_attempts.there_is_another
    datatype: yesnoradio
---
id: pay and stop eviction
decoration: circle-info
question: |
  % if person_answering == "tenant":
  You may be able to pay and stop the eviction
  % else:
  The tenant may be able to pay and stop the eviction
  % endif
subquestion: |
  % if person_answering == "tenant":
  If you:
  % if petition_states_rent_amount:
  
  * Pay the full ${ currency(rent_amount_owed) }, and 
  % else:
  
  * Pay the full amount you owe, and 
  % endif
  * Pay the full court costs

  You can stop the eviction and stay in your home.
  % else: 
  If the tenant:
  % if petition_states_rent_amount:
  
  * Pays the full ${ currency(rent_amount_owed) }, and 
  % else:
  
  * Pays the full amount they owe, and 
  % endif
  * Pays the full court costs

  The tenant can stop the eviction and stay in their home.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      Will you pay the full amount your landlord says you owe, plus court costs, to stop the eviction?
      % else:
      Will the tenant pay the full amount their landlord says the tenant owes them, plus court costs, to stop their eviction?
      % endif 
    field: will_offer_payment
    datatype: yesnoradio
---
id: warranty of habitability
question: |
  % if person_answering == "tenant":
  Does your home have any of the problems listed below?
  % else: 
  Does the tenant's home have any of the problems listed below?
  % endif
subquestion: |
  ${ collapse_template(bad_conditions_explanation_template) }

  You can also list problems that have been fixed if they happened with the last 2 years. 
fields: 
  - label: |
      % if person_answering == "tenant":
      Have you had any of these problems **in the last 2 years**?
      % else:
      Has the tenant had any of these problems **in the last 2 years**?
      % endif 
    field: warranty_breaches
    datatype: checkboxes
    choices: 
      - ${ conditions_text["no_heat"] }: no_heat
      - ${ conditions_text["no_cooling"] }: no_cooling
      - ${ conditions_text["insufficient_water"] }: insufficient_water
      - ${ conditions_text["insecure_locks"] }: insecure_locks
      - ${ conditions_text["mice_or_rats"] }: mice_or_rats
      - ${ conditions_text["roaches"] }: roaches
      - ${ conditions_text["bedbugs"] }: bedbugs
      - ${ conditions_text["chronic_dampness"] }: chronic_dampness
      - ${ conditions_text["standing_water"] }: standing_water
      - ${ conditions_text["electric_problem"] }: electric_problem
      - ${ conditions_text["lead_paint"] }: lead_paint
      - ${ conditions_text["leaky_windows"] }: leaky_windows
      - ${ conditions_text["has_plumbing_problems"] }: has_plumbing_problems
      - ${ conditions_text["has_structural_issues"] }: has_structural_issues
      - ${ conditions_text["ceiling_not_weathertight"] }: ceiling_not_weathertight
      - ${ conditions_text["floor_holes"] }: floor_holes
      - ${ conditions_text["trash"] }: trash
      - ${ conditions_text["fire_safety"] }: fire_safety
      - Other: other
  - label: |
      % if person_answering == "tenant":
      What other problems do you have?
      % else:
      What other problems does the tenant have?
      % endif 
    field: warranty_breach_other
    show if: warranty_breaches['other']
---
id: estoppel breaches
question: |
  % if person_answering == "tenant":
  Did your landlord violate other laws?
  % else: 
  Did the landlord violate other laws?
  % endif
subquestion: |
  ${ collapse_template(estoppel_explanation_template) }
fields:
  - Check any statement that is true: estoppel_breaches
    datatype: checkboxes
    choices:
      - ${ estoppel_breaches_text['not_up_to_code'] }: not_up_to_code
      - ${ estoppel_breaches_text['violated_law'] }: violated_law
      - ${ estoppel_breaches_text['occupancy_permit'] }: occupancy_permit
      - Other: other
  - label: |
      % if person_answering == "tenant":
      What other problems do you have?
      % else:
      What other problems does the tenant have?
      % endif 
    field: other_estoppel_breaches
    show if: estoppel_breaches['other']
---
variable name: estoppel_breaches_text
use objects: True
data:
  not_up_to_code:
    question: The home is not up to code.
    document: The home is not up to code.
  violated_law:
    question: The landlord violated local or state laws about the condition of the home.
    document: The landlord violated local or state laws about the condition of the home.
  occupancy_permit:
    document: The landlord does not have an occupancy permit for the home.
    question: The landlord does not have an occupancy permit for the home.
---
template: estoppel_explanation_template
subject: |
  What other laws does a landlord have to follow?
content: |
  In some areas, a landlord has to follow a "housing code" that specifies the condition of the home that the landlord must maintain.
  
  Other local or state laws can create requirements that a landlord must meet.
  
  An occupancy permit may be required for a landlord to rent a home.
---
variable name: conditions_text
use objects: True
data:
  no_heat:
    question: No heat or not enough heat in the winter time
    document: No heat or not enough heat in the winter time
  no_cooling:
    question: Too hot in the summer
    document: Too hot in the summer
  insufficient_water:
    question: Not enough hot or cold water
    document: Not enough hot or cold water
  insecure_locks:
    question: Locks are missing or not secure on windows or doors
    document: Locks are missing or not secure on windows or doors
  mice_or_rats:
    question: Mice or rats
    document: Mice or rats
  roaches:
    question: Cockroaches
    document: Cockroaches
  bedbugs:
    question: Bedbugs
    document: Bedbugs
  chronic_dampness:
    question: Mold, damp walls, ceilings or walls
    document: Mold, damp walls, ceilings or walls
  standing_water:
    question: Standing water or sewage
    document: Standing water or sewage
  electric_problem:
    question: Problem with electric wiring, outlets or switches
    document: Problem with electric wiring, outlets or switches
  lead_paint:
    question: Lead paint on a surface reachable by a young child
    document: Lead paint on a surface reachable by a young child
  leaky_windows:
    question: Windows are leaky
    document: Windows are leaky
  has_plumbing_problems:
    question: Has plumbing not in working order or is subject to flooding
    document: Has plumbing not in working order or is subject to flooding
  has_structural_issues:
    question: Dangerous structural problem, like unsafe stairs or railways
    document: Dangerous structural problem
  ceiling_not_weathertight:
    question: Ceiling has holes or cracks or is not weathertight
    document: Ceiling has holes or cracks or is not weathertight
  floor_holes:
    question: Floor has holes or cracks
    document: Floor has holes or cracks
  trash:
    question: Inadequate trash collection
    document: Inadequate trash collection
  fire_safety:
    question: Broken smoke detectors
    document: Broken smoke detectors
---
## leaving "you" references because not sure how to make conditional
variable name: cqe_breaches_text
use objects: True
data:
  harassment:
    question: |
      % if person_answering == "tenant":
      Harass you in person or on the phone
      % else:
      Harassed Tenant in person or on the phone
      % endif
    document: Harassed Tenant in person or on the phone
  visits:
    question: |
      % if person_answering == "tenant":
      Make frequent or unnecessary visits or inspections of the property
      % else:
      Made frequent or unnecessary visits or inspections of the property
      % endif
    document: Made frequent or unnecessary visits or inspections of the property
  remodeling:
    question: |
      % if person_answering == "tenant":
      Do unnecessary remodeling work, or maintenance work that takes longer than they promised
      % else:
      Performed unnecessary remodeling work, or maintenance work that took longer than they promised
      % endif
    document: Performed unnecessary remodeling work, or maintenance work that took longer than they promised
  access:
    question: |
      % if person_answering == "tenant":
      Allow construction that stops you from easily getting into your home or makes you take a long detour
      % else:
      Allows construction that stops the tenant from easily getting into their home or makes them take a long detour
      % endif
    document: Allows construction that stops the tenant from easily getting into their home or makes them take a long detour
  animal:
    question: |
      % if person_answering == "tenant":
      Allow their own dog or pet to bark constantly and disturb you
      % else:
      Allowed their dog or pet to bark constantly and disturb Tenant
      % endif 
    document: Allowed their dog or pet to bark constantly and disturb Tenant
  vermin:
    question: |
      % if person_answering == "tenant":
      Not exterminate or take care of vermin or pests in the walls making disruptive noises
      % else:
      Failed to exterminate or take care of vermin or pests in the walls making disruptive noises
      % endif
    document: Failed to exterminate or take care of vermin or pests in the walls making disruptive noises
---
template: bad_conditions_explanation_template
subject: |
  % if person_answering == "tenant":
  Why does the condition of my house matter?
  % else: 
  Why does the condition of the tenant's house matter?
  % endif
content: |
  % if person_answering == "tenant":
  Your landlord may owe you money if there are problems in your home. The money your landlord owes you might
  mean you do not owe part or all of the rent your landlord says you owe.
  
  Problems in your home may give you a claim for **Breach of Warranty of Habitability** 
  if the condition of your home affected your life, health, or safety, and made the dwelling uninhabitable in whole or in part.
  % else: 
  The landlord may owe the tenant money if there are problems in their home. The money the landlord owes the tenant might
  mean they do not owe part or all of the rent the landlord says the tenant owes.
  
  Problems in the tenant's home may give them a claim for **Breach of Warranty of Habitability** 
  if the condition of their home affected their life, health, or safety, and made the dwelling uninhabitable in whole or in part.  
  % endif
---
id: covenant of quiet enjoyment
question: |
  % if person_answering == "tenant":
  Did your landlord violate your right to live peacefully in your home?
  % else:
  Did the landlord violate the tenant's right to live peacefully in their home?
  % endif
subquestion: |
  ${ collapse_template(bqe_explanation_template) }
fields: 
  - label: |
      % if person_answering == "tenant":
      Did your landlord:
      % else:
      The landlord:
      % endif 
    field: cqe_breaches
    datatype: checkboxes
    choices:
      - ${ cqe_breaches_text["harassment"] }: harassment
      - ${ cqe_breaches_text["visits"] }: visits
      - ${ cqe_breaches_text["remodeling"] }: remodeling
      - ${ cqe_breaches_text["access"] }: access
      - ${ cqe_breaches_text["animal"] }: animal
      - ${ cqe_breaches_text["vermin"] }: vermin
      - ${ "Otherwise violate your right to live peacefully in your home" if person_answering == "tenant" else "Otherwise violated the tenant's right to live peacefully in their home"}: other
  - Other (explain): other_cqe_breach
    datatype: area
    show if: cqe_breaches["other"]
---
template: bqe_explanation_template
subject: |
  Why does this matter?
content: |
  % if person_answering == "tenant":
  Your landlord may owe you money if they violated your right to live peacefully in your home. The money may
  reduce the amount of rent you owe or mean that you do not owe any rent to your landlord.

  You have a claim of **Breach of Covenant of Quiet Enjoyment** if your landlord is responsible for a substantial
  disruption in the use and quiet enjoyment of your rental property.
  % else: 
  The landlord may owe the tenant money if they violated the tenant's right to live peacefully in their home. The money may
  reduce the amount of rent the tenant owes or mean that the tenant does not owe any rent to the landlord.

  The tenant has a claim of **Breach of Covenant of Quiet Enjoyment** if the landlord is responsible for a substantial
  disruption in the use and quiet enjoyment of the rental property.
  % endif
---
id: Rent paid
question: |
  % if person_answering == "tenant":
  Have you paid at least part of the rent your landlord says you owe?
  % else: 
  Has the tenant paid at least part of the rent the landlord says the tenant owes?
  % endif
subquestion: |
  % if person_answering == "tenant" and petition_states_rent_amount:
  You said your landlord said you owe ${ currency(rent_amount_owed) }.
  % elif petition_states_rent_amount:
  The tenant's landlord said the tenant owes ${ currency(rent_amount_owed) }.
  % endif
fields:
  - label: |
      % if person_answering == "tenant":
      I paid at least part of the rent
      % else:
      The tenant paid at least part of the rent
      % endif
    field: was_rent_paid
    datatype: yesnoradio
  - label: |
      % if person_answering == "tenant":
      How much did you pay?
      % else:
      How much did the tenant pay?
      % endif
    field: rent_amount_paid
    datatype: radio
    choices: 
      - ${ rent_amount_paid_text["all"] }: all
      - ${ rent_amount_paid_text["a_portion"] }: a_portion
    show if: was_rent_paid
---
variable name: rent_amount_paid_text
use objects: True
data:
  all:
    question: |
      % if person_answering == "tenant":
      I paid all of the rent
      % else:
      The tenant paid all of the rent
      % endif    
    document: |
      all
  a_portion:
    question: |
      % if person_answering == "tenant":
      I paid part of the rent
      % else:
      The tenant paid part of the rent
      % endif    
    document: |
      part
---
